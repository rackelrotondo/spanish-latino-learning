import { PrismaClient, Difficulty, LessonType } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  console.log('üå± Iniciando seed do banco de dados...')

  // 1. Criar badges padr√£o
  const badges = await createBadges()
  console.log('‚úÖ Badges criados')

  // 2. Criar pa√≠ses
  const countries = await createCountries()
  console.log('‚úÖ Pa√≠ses criados')

  // 3. Criar li√ß√µes do M√©xico
  const lessons = await createMexicoLessons()
  console.log('‚úÖ Li√ß√µes do M√©xico criadas')

  console.log('üéâ Seed conclu√≠do com sucesso!')
}

async function createBadges() {
  const badgeData = [
    {
      name: 'Primeiros Passos',
      description: 'Completou sua primeira li√ß√£o!',
      icon: 'üéØ',
      conditionType: 'lesson_completed',
      conditionValue: JSON.stringify({ count: 1 })
    },
    {
      name: 'Explorador do M√©xico',
      description: 'Completou 100% das li√ß√µes do M√©xico',
      icon: 'üá≤üáΩ',
      conditionType: 'country_completed',
      conditionValue: JSON.stringify({ country: 'MX' })
    },
    {
      name: 'Poliglota',
      description: 'Desbloqueou 3 pa√≠ses diferentes',
      icon: 'üåé',
      conditionType: 'countries_unlocked',
      conditionValue: JSON.stringify({ count: 3 })
    },
    {
      name: 'Mestre Cultural',
      description: 'Completou 10 li√ß√µes culturais',
      icon: 'üé≠',
      conditionType: 'culture_lessons',
      conditionValue: JSON.stringify({ count: 10 })
    },
    {
      name: 'Perfeccionista',
      description: 'Acertou 100% em 5 li√ß√µes',
      icon: '‚≠ê',
      conditionType: 'perfect_scores',
      conditionValue: JSON.stringify({ count: 5 })
    },
    {
      name: 'Guerreiro da Sequ√™ncia',
      description: 'Manteve sequ√™ncia de 7 dias',
      icon: 'üî•',
      conditionType: 'streak_days',
      conditionValue: JSON.stringify({ days: 7 })
    }
  ]

  for (const badge of badgeData) {
    await prisma.badge.upsert({
      where: { name: badge.name },
      update: {},
      create: badge
    })
  }

  return badgeData
}

async function createCountries() {
  const culturalData = {
    description: 'Ber√ßo de civiliza√ß√µes milenares como os astecas e maias, o M√©xico √© um pa√≠s de contrastes fascinantes.',
    traditions: [
      'D√≠a de los Muertos',
      'Mariachi e Serenatas',
      'Lucha Libre',
      'Festivais de Cores',
      'Artesanato Tradicional'
    ],
    musicGenres: [
      'Mariachi',
      'Ranchera',
      'Norte√±o',
      'Cumbia Mexicana',
      'Son Jarocho'
    ],
    foodItems: [
      'Tacos',
      'Mole',
      'Tamales',
      'Guacamole',
      'Chiles en Nogada'
    ],
    landmarks: [
      'Chichen Itz√°',
      'Teotihuac√°n',
      'Centro Hist√≥rico CDMX',
      'Riviera Maya',
      'Frida Kahlo Museum'
    ],
    films: [
      { title: 'Coco', year: 2017, significance: 'Dia de los Muertos' },
      { title: 'Como √Ågua para Chocolate', year: 1992, significance: 'Gastronomia e tradi√ß√µes' }
    ],
    artists: [
      { name: 'Vicente Fern√°ndez', genre: 'Ranchera', significance: 'Rei da m√∫sica ranchera' },
      { name: 'Jesse & Joy', genre: 'Pop Latino', significance: 'Dupla mexicana internacional' }
    ]
  }

  const languageData = {
    variantName: 'Espanhol Mexicano',
    accentDescription: 'Pron√∫ncia clara, ritmo melodioso, entona√ß√£o caracter√≠stica',
    uniqueWords: [
      { word: '¬°√ìrale!', meaning: 'Express√£o de surpresa ou √¢nimo' },
      { word: 'Chamaco/a', meaning: 'Crian√ßa, jovem' },
      { word: 'Padre/Padr√≠simo', meaning: 'Muito legal, incr√≠vel' },
      { word: 'Chido', meaning: 'Legal, bacana' }
    ],
    commonPhrases: [
      { phrase: '¬øQu√© onda?', meaning: 'E a√≠? Como vai?' },
      { phrase: 'Est√° padr√≠simo', meaning: 'Est√° muito legal' },
      { phrase: 'No manches', meaning: 'N√£o acredito' },
      { phrase: '√ìrale pues', meaning: 'Ent√£o t√° bom' }
    ]
  }

  const mexicoData = {
    code: 'MX',
    name: 'M√©xico',
    nameSpanish: 'M√©xico',
    capital: 'Cidade do M√©xico',
    population: '128 milh√µes',
    flagUrl: '/flags/mexico.svg',
    requiredXP: 0,
    difficulty: Difficulty.BEGINNER,
    culturalComplexity: 4,
    linguisticVariation: 3,
    svgPath: 'M450,380 L470,360 L490,380 L510,400 L490,420 L470,400 Z',
    positionX: 450,
    positionY: 380,
    culturalData: JSON.stringify(culturalData),
    languageData: JSON.stringify(languageData)
  }

  await prisma.country.upsert({
    where: { code: 'MX' },
    update: {},
    create: mexicoData
  })

  return [mexicoData]
}

async function createMexicoLessons() {
  const lessons = [
    {
      id: 'mx-basic-1',
      countryCode: 'MX',
      title: 'Sauda√ß√µes Mexicanas',
      type: LessonType.VOCABULARY,
      difficulty: Difficulty.BEGINNER,
      estimatedTime: 15,
      xpReward: 50,
      orderIndex: 1,
      culturalIntro: JSON.stringify({
        title: 'A Hospitalidade Mexicana',
        content: 'No M√©xico, as sauda√ß√µes s√£o mais que cortesia - s√£o uma express√£o da calorosa hospitalidade mexicana. A cultura mexicana valoriza profundamente as rela√ß√µes interpessoais e isso se reflete na forma carinhosa de cumprimentar.',
        vocabulary: [
          {
            spanish: 'Hola',
            portuguese: 'Oi/Ol√°',
            pronunciation: '√≥-la',
            culturalNote: 'Sauda√ß√£o universal, sempre acompanhada de um sorriso'
          },
          {
            spanish: 'Buenos d√≠as',
            portuguese: 'Bom dia',
            pronunciation: 'bu√©-nos d√≠-as',
            culturalNote: 'Usado at√© aproximadamente 12h, muito respeitoso'
          },
          {
            spanish: '¬øQu√© tal?',
            portuguese: 'Como vai?',
            pronunciation: 'k√© tal',
            culturalNote: 'Informal e amig√°vel, perfeito entre amigos'
          },
          {
            spanish: '¬°√ìrale!',
            portuguese: 'Nossa!/Poxa!',
            pronunciation: '√≥-ra-le',
            culturalNote: 'Express√£o tipicamente mexicana de surpresa ou √¢nimo'
          }
        ],
        culturalNotes: [
          'Mexicanos frequentemente cumprimentam com beijo no rosto, mesmo em encontros casuais',
          'O contato visual durante a sauda√ß√£o √© muito importante na cultura mexicana',
          '√â comum perguntar sobre a fam√≠lia logo ap√≥s a sauda√ß√£o'
        ],
        mediaReferences: [
          {
            type: 'filme',
            title: 'Coco',
            description: 'Observe como Miguel sa√∫da diferentes personagens, refletindo a hierarquia familiar mexicana',
            connection: 'As sauda√ß√µes mostram respeito pela fam√≠lia e tradi√ß√µes'
          },
          {
            type: 'm√∫sica',
            artist: 'Jesse & Joy',
            song: 'Espacio Sideral',
            description: 'Preste aten√ß√£o nas sauda√ß√µes calorosas das entrevistas da dupla',
            connection: 'Demonstra a naturalidade mexicana em intera√ß√µes'
          }
        ]
      }),
      questions: JSON.stringify([
        {
          id: 'q1',
          type: 'multiple-choice',
          question: 'Como voc√™ diria "Oi" em espanhol mexicano?',
          options: ['Hola', 'Buenos', '√ìrale', 'Qu√©'],
          correctAnswer: 'Hola',
          explanation: '"Hola" √© a sauda√ß√£o mais comum e universal em espanhol.',
          culturalContext: 'No M√©xico, sempre √© acompanhada de um sorriso caloroso!'
        },
        {
          id: 'q2',
          type: 'translation',
          question: 'Traduza: "Buenos d√≠as, ¬øqu√© tal?"',
          correctAnswer: 'Bom dia, como vai?',
          explanation: 'Uma sauda√ß√£o completa muito comum no M√©xico.',
          culturalContext: 'Demonstra educa√ß√£o e interesse genu√≠no pela pessoa.'
        },
        {
          id: 'q3',
          type: 'cultural-context',
          question: 'Qual express√£o √© tipicamente mexicana para demonstrar surpresa?',
          options: ['¬°√ìrale!', '¬°Hola!', '¬°Buenos!', '¬°Qu√©!'],
          correctAnswer: '¬°√ìrale!',
          explanation: '¬°√ìrale! √© uma express√£o muito caracter√≠stica do espanhol mexicano.',
          culturalContext: 'Pode expressar surpresa, admira√ß√£o ou simplesmente enfatizar algo!'
        }
      ]),
      isPublished: true
    },
    {
      id: 'mx-basic-2',
      countryCode: 'MX',
      title: 'Gastronomia Mexicana',
      type: LessonType.CULTURE,
      difficulty: Difficulty.BEGINNER,
      estimatedTime: 20,
      xpReward: 75,
      orderIndex: 2,
      culturalIntro: JSON.stringify({
        title: 'Patrim√¥nio Gastron√¥mico da Humanidade',
        content: 'A gastronomia mexicana foi declarada Patrim√¥nio Cultural Imaterial da Humanidade pela UNESCO em 2010. Mais que alimenta√ß√£o, √© uma express√£o de identidade cultural que conecta o presente com as tradi√ß√µes ancestrais astecas e maias.',
        vocabulary: [
          {
            spanish: 'Taco',
            portuguese: 'Taco',
            pronunciation: 't√°-ko',
            culturalNote: 'O prato mais ic√¥nico, cada regi√£o tem sua vers√£o especial'
          },
          {
            spanish: 'Tortilla',
            portuguese: 'Tortilha',
            pronunciation: 'tor-t√≠-lla',
            culturalNote: 'Base da alimenta√ß√£o mexicana, feita de milho sagrado'
          },
          {
            spanish: 'Salsa',
            portuguese: 'Molho',
            pronunciation: 's√°l-sa',
            culturalNote: 'Cada fam√≠lia tem sua receita secreta de salsa'
          },
          {
            spanish: 'Guacamole',
            portuguese: 'Guacamole',
            pronunciation: 'gua-ka-m√≥-le',
            culturalNote: 'Criado pelos astecas, ainda preparado tradicionalmente'
          }
        ],
        culturalNotes: [
          'O milho √© considerado sagrado na cultura mexicana - base das tortillas',
          'Mercados locais s√£o o cora√ß√£o da gastronomia, onde encontrar ingredientes frescos',
          'Comida de rua √© uma arte no M√©xico - taquerias s√£o institui√ß√µes culturais'
        ],
        mediaReferences: [
          {
            type: 'filme',
            title: 'Como √Ågua para Chocolate',
            description: 'Mostra como a comida carrega emo√ß√µes e tradi√ß√µes familiares',
            connection: 'Comida como linguagem de amor e mem√≥ria cultural'
          },
          {
            type: 'tradi√ß√£o',
            title: 'D√≠a de los Muertos',
            description: 'Pratos especiais para honrar os ancestrais',
            connection: 'Gastronomia conecta vivos e mortos na cultura mexicana'
          }
        ]
      }),
      questions: JSON.stringify([
        {
          id: 'q1',
          type: 'multiple-choice',
          question: 'Qual √© a base tradicional da tortilla mexicana?',
          options: ['Trigo', 'Milho', 'Arroz', 'Aveia'],
          correctAnswer: 'Milho',
          explanation: 'As tortillas tradicionais s√£o feitas de milho, ingrediente sagrado para os astecas.',
          culturalContext: 'O milho √© considerado o alimento que deu origem aos seres humanos na mitologia maia.'
        },
        {
          id: 'q2',
          type: 'cultural-context',
          question: 'Por que a gastronomia mexicana √© Patrim√¥nio da Humanidade?',
          options: [
            'Por ser saborosa',
            'Por conectar tradi√ß√µes ancestrais com presente',
            'Por ser popular',
            'Por usar muitas especiarias'
          ],
          correctAnswer: 'Por conectar tradi√ß√µes ancestrais com presente',
          explanation: 'A UNESCO reconheceu a gastronomia mexicana por preservar tradi√ß√µes milenares.',
          culturalContext: 'Cada prato conta uma hist√≥ria que vem dos astecas e maias!'
        },
        {
          id: 'q3',
          type: 'translation',
          question: 'Como voc√™ pediria "um taco com guacamole" em espanhol?',
          correctAnswer: 'Un taco con guacamole',
          explanation: 'Estrutura simples: un + prato + con + acompanhamento.',
          culturalContext: 'Nos mercados mexicanos, √© comum personalizar seu taco com diferentes molhos!'
        }
      ]),
      isPublished: true
    }
  ]

  for (const lesson of lessons) {
    await prisma.lesson.upsert({
      where: { id: lesson.id },
      update: {},
      create: lesson
    })
  }

  return lessons
}

main()
  .then(async () => {
    await prisma.$disconnect()
  })
  .catch(async (e) => {
    console.error(e)
    await prisma.$disconnect()
    process.exit(1)
  })
